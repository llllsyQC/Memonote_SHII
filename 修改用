For j = LBound(categoryNames) To UBound(categoryNames)
    currentCategory = categoryNames(j)

    If categoryRow.exists(currentCategory) Then
        startRow = categoryRow(currentCategory) + 1
        endRow = lastRow

        For i = startRow To lastRow
            If categoryRow.exists(wsSource.Cells(i, 2).Value) And wsSource.Cells(i, 2).Value <> "定期巡回" Then
                endRow = i - 1
                Exit For
            End If
        Next i
    Else
        startRow = 0
        endRow = 0
    End If

    Set wsTarget = GetOrCreateSheet(currentCategory)
    wsTarget.Cells.UnMerge

    If Application.WorksheetFunction.CountA(wsTarget.Range("A:A")) = 0 Then
        targetLastRow = 1
    Else
        targetLastRow = wsTarget.Cells(wsTarget.Rows.Count, "A").End(xlUp).Row
        If wsTarget.Cells(targetLastRow, 1).Value <> "" Then targetLastRow = targetLastRow + 1
    End If

    hasData = False
    colStart = 39 ' AM列（工数数据开始）

    If startRow > 0 And endRow >= startRow Then
        For i = startRow To endRow
            ' ✅ 修复1：稳定判断是否为空行
            isEmptyRow = True
            For Each c In wsSource.Range(wsSource.Cells(i, colStart), wsSource.Cells(i, colStart + 40))
                If Trim(c.Value) <> "" Then
                    isEmptyRow = False
                    Exit For
                End If
            Next c

            If isEmptyRow Then GoTo SkipRow

            ' ✅ 修复2：稳定计算粘贴的列范围，限制最大列
            colEnd = wsSource.Cells(i, wsSource.Columns.Count).End(xlToLeft).Column
            If colEnd < colStart Then colEnd = colStart
            If colEnd > colStart + 40 Then colEnd = colStart + 40

            ' ✅ 粘贴数据（日期+数据）
            wsTarget.Cells(targetLastRow, 1).Value = dateValue
            wsSource.Range(wsSource.Cells(i, colStart), wsSource.Cells(i, colEnd)).Copy
            wsTarget.Cells(targetLastRow, 2).PasteSpecial Paste:=xlPasteValues

            targetLastRow = targetLastRow + 1
            hasData = True
SkipRow:
        Next i
    End If

    ' ✅ 如果没数据，只写入日期+“なし”
    If hasData = False Then
        wsTarget.Cells(targetLastRow, 1).Value = dateValue
        wsTarget.Cells(targetLastRow, 3).Value = "なし"
    End If
Next j


最近、データセンターの電力需要に関する記事を読み、特に生成AIの普及が引き起こす電力消費の急増に強い衝撃を受けました。ChatGPTのようなAIツールは、一回のクエリで従来の検索の約10倍もの電力を使用すると知り、日常的に使っている技術が想像以上にエネルギーを消費していることに驚きました。

また、アイルランドでは、データセンターが国全体の電力消費の3分の1を占める可能性があるという予測には、正直危機感を抱きました。電力供給の信頼性や再生可能エネルギーとのバランスが今後さらに重要になると感じます。

一方で、ソフトバンクのようにカーボンニュートラルの実現に向けて具体的な目標を掲げ、北海道苫小牧で再生可能エネルギー100%の分散型AIデータセンター「Core Brain」を建設するなど、前向きな取り組みには感銘を受けました。AIの成長と環境保護を両立するには、企業の責任と行動がますます問われる時代になったと実感しました。
