Sub Copy_WorkHours_By工数番号_正確版()

    Dim wsSrc As Worksheet, wsDest As Worksheet
    Dim 工数Map As Object
    Dim srcRow As Long, destRow As Long, col As Long
    Dim 工数番号 As String
    Dim matchCount As Long

    Set wsSrc = ThisWorkbook.Worksheets("0消し(最終)")
    Set wsDest = ThisWorkbook.Worksheets("工数取得-都度対応項目(時間)")
    Set 工数Map = CreateObject("Scripting.Dictionary")

    ' Step 1：建立目标Sheet（都度対応）の工数番号 → 行映射（I11:I64）
    For destRow = 11 To 64
        工数番号 = Trim(CStr(wsDest.Cells(destRow, "I").Value))
        If 工数番号 <> "" Then
            工数Map(工数番号) = destRow
        End If
    Next

    ' Step 2：从源表（0消）读取工数番号（E6:E52）
    For srcRow = 6 To 52
        工数番号 = Trim(CStr(wsSrc.Cells(srcRow, "E").Value))
        If 工数Map.exists(工数番号) Then
            destRow = 工数Map(工数番号)
            matchCount = matchCount + 1
            ' 复制数据 F列(6) ～ EH列(138)
            For col = 6 To 138
                With wsDest.Cells(destRow, col)
                    .NumberFormat = "h:mm"
                    .Value = wsSrc.Cells(srcRow, col).Value
                End With
            Next col
        End If
    Next

    MsgBox "Step 2（正確版）完了！一致件数: " & matchCount, vbInformation

End Sub