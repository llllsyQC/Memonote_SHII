Sub Copy_WorkHours_By工数番号()

    Dim wsSrc As Worksheet, wsDest As Worksheet
    Dim 工数Map As Object
    Dim srcRow As Long, destRow As Long, col As Long
    Dim 工数番号 As String
    Dim matchCount As Long

    Set wsSrc = ThisWorkbook.Worksheets("0消し(最終)")
    Set wsDest = ThisWorkbook.Worksheets("工数取得-都度対応項目(時間)")
    Set 工数Map = CreateObject("Scripting.Dictionary")

    ' Step 1：构建“目标Sheet”的 工数番号 → 实际行号 的映射（I11:I64）
    For destRow = 11 To 64
        工数番号 = Trim(CStr(wsDest.Cells(destRow, "I").Value))
        If 工数番号 <> "" Then
            工数Map(工数番号) = destRow ' → 保留真实行号
        End If
    Next

    ' Step 2：从源Sheet中读取 工数番号（E6:E52），去目标Sheet中寻找对应行
    For srcRow = 6 To 52
        工数番号 = Trim(CStr(wsSrc.Cells(srcRow, "E").Value))
        If 工数Map.exists(工数番号) Then
            destRow = 工数Map(工数番号) ' → 使用真实目标行
            matchCount = matchCount + 1
            For col = 6 To 138 ' F:EH列
                With wsDest.Cells(destRow, col)
                    .NumberFormat = "h:mm"
                    .Value = wsSrc.Cells(srcRow, col).Value
                End With
            Next col
        Else
            Debug.Print "未匹配工数番号: " & 工数番号
        End If
    Next

    MsgBox "Step 2 完了！正確貼付成功：" & matchCount & " 件", vbInformation

End Sub